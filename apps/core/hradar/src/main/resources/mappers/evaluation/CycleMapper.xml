<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.hit.hradar.domain.evaluation.query.mapper.CycleMapper">
    <select id="selectCycleList"
            resultType="org.hit.hradar.domain.evaluation.query.dto.response.CycleListResponseDto">

        SELECT
            c.cycle_id   AS cycleId,
            c.cycle_name AS cycleName,
            c.start_date AS startDate,
            c.end_date   AS endDate,
            c.status     AS status,
            c.emp_id     AS empId
        FROM cycle c
        WHERE c.is_deleted = 'N'
        ORDER BY c.start_date DESC

    </select>

    <select id="selectCycleDetail"
            parameterType="long"
            resultType="org.hit.hradar.domain.evaluation.query.dto.response.CycleDetailResponseDto">

        SELECT
            c.cycle_id   AS cycleId,
            c.cycle_name AS cycleName,
            c.quarter    AS quarter,
            c.is_comp_report_generated AS isCompReportGenerated,
            c.start_date AS startDate,
            c.end_date   AS endDate,
            c.status     AS status,
            c.emp_id     AS empId
        FROM cycle c
        WHERE c.cycle_id = #{cycleId}
          AND c.is_deleted = 'N'

    </select>
    <select id="selectEvaluationTypesByCycleId"
            parameterType="long"
            resultType="string">

        SELECT et.type_name
        FROM evaluation_type et
                 JOIN cycle_evaluation_type cet
                      ON cet.eval_type_id = et.eval_type_id
        WHERE cet.cycle_id = #{cycleId}
          AND et.is_deleted = 'N'
          AND cet.is_deleted = 'N'

    </select>

</mapper>