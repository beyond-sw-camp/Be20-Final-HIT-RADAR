<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.hit.hradar.domain.grading.query.mapper.CompanyGradeMapper">

    <select id="findCompanyGradesWithRule"
            parameterType="long"
            resultType="org.hit.hradar.domain.grading.query.dto.response.CompanyGradeWithRuleListResponseDto">

        SELECT
            g.grade_id    AS gradeId,
            g.grade_name  AS gradeName,
            g.grade_order AS gradeOrder,

            r.min_ratio   AS minRatio,
            r.max_ratio   AS maxRatio

        FROM grade g
                 LEFT JOIN grade_distribution_rule r
                           ON g.grade_id = r.grade_id
                               AND r.is_deleted = 'N'

        WHERE g.com_id = #{companyId}
          AND g.is_deleted = 'N'

        ORDER BY g.grade_order ASC

    </select>

</mapper>