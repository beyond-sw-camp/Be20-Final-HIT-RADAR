# AWS Infrastructure Configuration Guide (EKS) - Updated

이 파일은 AWS EKS 환경에서 애플리케이션 서비스들을 실행하기 위해 필요한 주요 환경 변수와 Secret 항목들을 정리한 문서입니다. (최신 보안 설정 반영)

## 1. AWS Secrets Manager 설정 항목 (External Secret용)

### A. 공용 설정 (`prod/hr-system/common`)
대부분의 공용 환경 변수 및 인증 정보가 위치합니다.

| 키 (Key) | 설명 | 예시 / 비고 |
| :--- | :--- | :--- |
| `DB_HOST` | RDS 호스트 주소 | `<rds-endpoint>.ap-northeast-2.rds.amazonaws.com` |
| `DB_PORT` | RDS 포트 | `3306` |
| `DB_NAME` | 데이터베이스 이름 | `hradar` |
| `DB_USER` | RDS 사용자 계정 | `admin` |
| `REDIS_HOST` | ElastiCache Redis 엔드포인트 | `<redis-cluster-endpoint>` |
| `REDIS_PORT` | Redis 포트 | `6379` |
| `JWT_SECRET_KEY` | JWT 서명용 비밀키 | `base64-encoded-random-string` |
| `INTERNAL_TOKEN` | 서비스 간 통신용 인증 토큰 | `random-string` |
| `AWS_ACCESS_KEY_ID` | S3 접근용 Access Key | (필요 시) |
| `AWS_SECRET_ACCESS_KEY` | S3 접근용 Secret Key | (필요 시) |
| `GMAIL_USERNAME` | 메일 발송용 Gmail 계정 | `example@gmail.com` |
| `GMAIL_APP_PASSWORD` | Gmail 앱 비밀번호 | `abcd-efgh-ijkl-mnop` |
| `MONGO_USER` | Chatbot용 MongoDB 루트 계정 | `admin` |
| `MONGO_PASSWORD` | Chatbot용 MongoDB 비밀번호 | `********` |
| `MONGO_DB` | Chatbot용 MongoDB 데이터베이스 이름 | `hr-chatbot` |

### B. RDS 전용 설정 (`rds!db-8465fc3a-4e4d-4f0b-8300-dfe0178630b8`)
보안을 위해 RDS 비밀번호는 별도의 암호 이름으로 관리됩니다.

| 키 (Key) | 설명 | 예시 / 비고 |
| :--- | :--- | :--- |
| `DB_PASSWORD` | RDS 비밀번호 | `********` |

---

## 2. ConfigMap 설정 항목 (일반 환경 변수)
`HIT-HRadar-Infra/k8s/configmap.yaml` 참조.

- `SPRING_PROFILES_ACTIVE`: `prod`
- `S3_BUCKET`: `s3-hradar-bucket`
- `QDRANT_HOST`: `qdrant` (Internal)
- `KAFKA_BROKERS`: `kafka-headless:9092` (Internal)

---

## 3. 요약 및 주의사항
1. **DB_URL 생성**: `secrets-store.yaml`에서 `DB_HOST`, `DB_PORT`, `DB_NAME`을 조합하여 `DB_URL`을 자동 생성합니다.
2. **MONGO_URI 생성**: `MONGO_USER`, `MONGO_PASSWORD`, `MONGO_DB`를 조합하여 클러스터 내부의 `mongodb` 서비스를 바라보는 `MONGO_URI`를 자동 생성합니다.
3. **MongoDB (내부)**: `mongodb.yaml`을 통해 클러스터 내부에 배포되므로 별도의 외부 DB 연결 설정이 필요하지 않습니다.
